{% extends 'base.html' %}
{% load thumbnail %}
{% load static %}
{% block title %}ЯЛ ӖҪЧЕНӖ - Янтиковская районная газета "Селький труженик"{% endblock %}

{% block breadcrumb %}
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item active" aria-current="page"><i class="fas fa-home"></i> Главная</li>
          </ol>
        </nav>
{% endblock breadcrumb %}

{% block open_graph %}
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="ru_RU">
  <meta property="og:title" content="ЯЛ ӖҪЧЕНӖ - Янтиковская районная газета 'Селький труженик'">
  <meta property="og:description" content="ЯЛ ӖҪЧЕНӖ - Янтиковская районная газета 'Селький труженик', новости редакции">
  <meta property="og:url" content="http://{{ request.site.name }}">
  <meta property="og:site_name" content="ЯЛ ӖҪЧЕНӖ - Янтиковская районная газета 'Селький труженик'">
  {% if all_news.0.image %}
      <meta property="og:image" content="http://{{ request.site.name }}/media/{{ all_news.0.image }}">
  {% endif %}
{% endblock %}

{% block main %}
            <div class="row">
              <div class="col-9">
                <div class="row">
                  <div class="col-8 news">
                    <div class="news__badge-all-news">
                      <a href="{% url 'news:news' %}">
                        <span class="badge badge-danger">Все новости</span>
                      </a>
                    </div>

                    {% for news in all_news %}
                      {% if news.visible %}
                      <div class="news__post">

                          <div class="news__header">
                              <a class="news__header-text" href="{{ news.get_absolute_url }}">{{ news.title }}</a>
                              {% if news.type == "actuals" %}
                                  <a href="{% url 'news:actuals' %}">
                                    <span class="badge badge-info">Актуально</span>
                                  </a>
                              {% endif %}
                          </div>
                          {% if news.image %} {# Если новость имеет изображение #}
                            {% if forloop.first %} {# Если новость первая в forloop (у первой новости ширина изображения 100%) #}
                              <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                                <div class="carousel-inner">
                                      <div class="carousel-item active">
                                        <a href="/media/{{ news.image }}" rel="gallery" class="swipebox" title="{{ news.title }}">
                                          {% thumbnail news.image "500x350" crop="center" as im %}
                                          {# Главное видео новости #}
                                            <img class="d-block w-100 rounded" alt="{{ news.title }}" src="{{ im.url }}" width="{{ im.width }}">
                                          {% endthumbnail %}
                                        </a>
                                      </div>
                                  {% for photogallery in news.photogallery.all %} 
                                  {# Главное видео видеоновости #}
                                        <div class="carousel-item">
                                          <a href="/media/{{ photogallery.image }}" rel="gallery" class="swipebox" title="{{ news.title }}">
                                            {% thumbnail photogallery.image "500x350" crop="center" as im %}
                                                <img class="d-block w-100 rounded" src="{{ im.url }}" width="{{ im.width }}" alt="{{ photogallery.title }}">
                                            {% endthumbnail %}
                                          </a>
                                        </div>
                                        {% for imgs in photogallery.news_images.all %}
                                          {# видеографии видеоновости #}
                                          <div class="carousel-item">
                                            <a href="/media/{{ imgs.image }}" rel="gallery" class="swipebox" title="{{ news.title }}">
                                              {% thumbnail imgs.image "500x350" crop="center" as im %}
                                                  <img class="d-block w-100 rounded" src="{{ im.url }}" width="{{ im.width }}" alt="{{ photogallery.title }}">
                                              {% endthumbnail %}
                                            </a>
                                          </div>
                                        {% endfor %}
                                  {% endfor %}
                                      </div>
                                      {# Навигация #}
                                      {% comment %}
                                        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                          <span class="sr-only">Назад</span>
                                        </a>
                                        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                                          <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                          <span class="sr-only">Вперед</span>
                                        </a>
                                      {% endcomment %}
                                    </div>
                            {% else %}
                              {% thumbnail news.image "300" crop="center" as im %}
                                <img class="rounded float-left news__post-imgs" alt="{{ news.title }}" src="{{ im.url }}" data-holder-rendered="true" width="{{ im.width }}" height="{{ im.height }}">
                              {% endthumbnail %}
                            {% endif %}
                          {% endif %}

                          <div class="text-justify news__content">
                            {% if news.image %}
                              <p>
                                {{ news.content|safe|striptags|truncatewords_html:50 }}
                                <a class="font-weight-bold" href="{{ news.get_absolute_url }}"> подробнее</a>
                              </p>
                            {% else %}
                              <p>
                                {{ news.content|safe|striptags|truncatewords_html:30 }}
                                <a class="font-weight-bold" href="{{ news.get_absolute_url }}"> подробнее</a>
                              </p>
                              {% endif %}
                          </div>
                          <div class="clearfix"></div>
                          <div class="news__created"><i class="far fa-calendar-alt"></i> {{ news.publish }}</div>
                      </div>
                      {% endif %} {# news.visible #}
                    {% endfor %}
                    {% comment %}
                      <div class="all_publications"><a href="{% url 'news:news' %}" class="btn btn-danger btn-sm">Перейти к новостям</a></div>
                    {% endcomment %}
                  </div>

                  <div class="col-4 news">
                    <div class="news__badge-all-news">
                      <a href="{% url 'news:publications' %}">
                        <span class="badge badge-danger">Все публикации</span>
                      </a>
                    </div>
                    {% for publication in all_publications %}
                    <div class="news__post">
                      <div class="news__header">
                        <a class="news__header-text" href="{{ publication.get_absolute_url }}">{{ publication.title }}</a>
                      </div>
                      {% if publication.image %}
                        {% thumbnail publication.image "250" crop="center" as im %}
                          <img class="rounded w-100" alt="" src="{{ im.url }}" data-holder-rendered="true" width="{{ im.width }}" height="{{ im.height }}">
                        {% endthumbnail %}
                      {% endif %}
                      <div class="text-center news__content">
                        <p>
                          {{ publication.content|safe|striptags|truncatewords_html:20 }}
                          <a class="font-weight-bold" href="{{ publication.get_absolute_url }}"> тĕплĕнрех</a>
                        </p>
                      </div>
                      <div class="news__created"><i class="far fa-calendar-alt"></i> {{ publication.publish }}</div>
                    </div>
                    {% endfor %}
                    {% comment %}
                      <div class="all_publications"><a href="{% url 'news:publications' %}" class="btn btn-danger btn-sm">Перейти к публикациям</a></div>
                    {% endcomment %}
                  </div>
                </div>
                
                {# Фотогалереи #}
                <div class="row">
                  <div class="col-12">
                    <div>ФОТОГАЛЕРЕИ</div>
                    <div class="news__badge-all-news">
                      <a href="{% url 'news:photogallery' %}">
                        <span class="badge badge-danger">Все фотогалереи</span>
                      </a>
                    </div>
                    {% for photogallery in all_photogallery %}
                      <div class="news__post">
                        <div class="row news">
                          <div class="col-3">
                            {% thumbnail photogallery.image "200" crop="center" as im %}
                                <img class="rounded float-left w-100" alt="" src="{{ im.url }}" data-holder-rendered="true" width="{{ im.width }}" height="{{ im.height }}">
                            {% endthumbnail %}
                          </div>
                        <div class="col-6">
                            <a class="news__header-text news__header-text_small news__header-text_va-bottom" href="{{ photogallery.get_absolute_url }}">{{ photogallery.title }}</a>
                        </div>
                          
                          <div class="col-3 photogallery-post_additional">
                            <div class="news__created">{{ photogallery.publish }}</div>
                        </div>
                        </div>
                      </div>
                    {% endfor %}
                  </div>
                </div>

                {# Видеоновости #}
                <div class="row">
                  <div class="col-12">
                    <div>ВИДЕОНОВОСТИ</div>
                    <div class="news__badge-all-news">
                      <a href="{% url 'news:videonews' %}">
                        <span class="badge badge-danger">Все видеоновости</span>
                      </a>
                    </div>
                    {% for videonews in all_videonews %}
                      <div class="news__post">
                        <div class="row news">
                          <div class="col-3">
                            {% if videonews.image %}
                              {% thumbnail videonews.image "180x120" crop="center" as im %}
                                  <a href="{{ videonews.get_absolute_url }}">
                                    <img alt="{{ videonews.title}}" src="{{ im.url }}" data-holder-rendered="true" width="{{ im.width }}" height="{{ im.height }}">
                                  </a>
                              {% endthumbnail %}
                            {% else %}
                              {% if videonews.video %}
                              {# Если видео загружено физически #}
                                  <video style="outline:none; width:100%; height:120px;" controls>
                                    <source src="/media/{{ videonews.video }}" type="video/mp4">
                                    <a href="/media/{{ videonews.video }}" download="download" target="_blank">Скачать видео</a>
                                  </video>
                              {% elif videonews.cap %}
                              {# Если видео с video.cap.ru #}
                                  <video style="outline:none; width:100%; height:120px;" controls="controls">
                                    <source src="{{ videonews.cap }}" type="video/mp4">
                                    <a href="{{ videonews.cap }}" download="download" target="_blank">Скачать видео</a>
                                  </video>
                              {% elif videonews.youtube %}
                              {# Если видео с youtube.com #}
                                  <iframe style="outline:none; width:100%; height:120px;" src="https://www.youtube.com/embed/{{ videonews.youtube}}" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"></iframe>
                              {% else %}
                              {# Если ссылка на видео в контенте #}
                                  <a href="{{ videonews.get_absolute_url }}">
                                    <img alt="{{ videonews.title }}" src="{% static 'images/video_preview_icon.png' %}" width="180" height="120">
                                  </a>
                              {% endif %}
                            {% endif %}
                          </div>
                        <div class="col-6">
                            <a class="news__header-text news__header-text_small news__header-text_va-bottom" href="{{ videonews.get_absolute_url }}">{{ videonews.title }}</a>
                        </div>
                          <div class="col-3 videonews-post_additional">
                            <div class="news__created">{{ videonews.publish }}</div>
                        </div>
                        </div>
                      </div>
                    {% endfor %}
                  </div>
                </div>

              </div>
              {% include "include_banners.html" %}
            </div>
{% endblock %}